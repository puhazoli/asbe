---

title: Title


keywords: fastai
sidebar: home_sidebar



nb_path: "ihdp.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: ihdp.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">asbe.base</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">asbe.models</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">econml.orf</span> <span class="k">import</span> <span class="n">DMLOrthoForest</span>
<span class="kn">from</span> <span class="nn">econml.dml</span> <span class="k">import</span> <span class="n">CausalForestDML</span>
<span class="kn">from</span> <span class="nn">causalml.inference.nn</span> <span class="k">import</span> <span class="n">CEVAE</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">deepcopy</span>
<span class="kn">import</span> <span class="nn">econml</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/opt/anaconda3/lib/python3.7/site-packages/dask/dataframe/utils.py:14: FutureWarning: pandas.util.testing is deprecated. Use the functions in the public API at pandas.testing instead.
  import pandas.util.testing as tm
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://raw.githubusercontent.com/AMLab-Amsterdam/CEVAE/master/datasets/IHDP/csv/ihdp_npci_1.csv&quot;</span><span class="p">,</span>
    <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;treatment&quot;</span><span class="p">,</span> <span class="s2">&quot;y_factual&quot;</span><span class="p">,</span> <span class="s2">&quot;y_cfactual&quot;</span><span class="p">,</span> <span class="s2">&quot;mu0&quot;</span><span class="p">,</span> <span class="s2">&quot;mu1&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">f</span><span class="s1">&#39;x</span><span class="si">{x}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s2">&quot;x0&quot;</span><span class="p">:]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;treatment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="c1">#t = np.zeros_like(t)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y_factual&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;treatment&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>
               <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y_factual&#39;</span><span class="p">],</span>
               <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y_cfactual&#39;</span><span class="p">])</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;treatment&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
               <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y_factual&#39;</span><span class="p">],</span>
               <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y_cfactual&#39;</span><span class="p">])</span>
<span class="n">ite</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;treatment&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>
               <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y_factual&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y_cfactual&quot;</span><span class="p">],</span>
               <span class="n">df</span><span class="p">[</span><span class="s1">&#39;y_cfactual&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;y_factual&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">t_train</span><span class="p">,</span> <span class="n">t_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">ite_train</span><span class="p">,</span> <span class="n">ite_test</span><span class="p">,</span> <span class="n">y1_train</span><span class="p">,</span> <span class="n">y1_test</span><span class="p">,</span> <span class="n">y0_train</span><span class="p">,</span> <span class="n">y0_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ite</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span>  <span class="n">test_size</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1005</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;X_training&quot;</span><span class="p">:</span> <span class="n">X_train</span><span class="p">,</span>
     <span class="s2">&quot;y_training&quot;</span><span class="p">:</span> <span class="n">y_train</span><span class="p">,</span>
     <span class="s2">&quot;t_training&quot;</span><span class="p">:</span> <span class="n">t_train</span><span class="p">,</span>
     <span class="s2">&quot;X_pool&quot;</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> 
     <span class="s2">&quot;y_pool&quot;</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span>
     <span class="s2">&quot;t_pool&quot;</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">t_test</span><span class="p">),</span>
     <span class="s2">&quot;y1_pool&quot;</span><span class="p">:</span> <span class="n">y1_test</span><span class="p">,</span>
     <span class="s2">&quot;y0_pool&quot;</span><span class="p">:</span><span class="n">y0_test</span><span class="p">,</span>
     <span class="s2">&quot;X_test&quot;</span><span class="p">:</span> <span class="n">X_test</span><span class="p">,</span>
     <span class="s2">&quot;y_test&quot;</span><span class="p">:</span> <span class="n">y_test</span><span class="p">,</span>
      <span class="s2">&quot;t_test&quot;</span><span class="p">:</span> <span class="n">t_test</span><span class="p">,</span>
      <span class="s2">&quot;ite_test&quot;</span><span class="p">:</span> <span class="n">ite_test</span>
     <span class="p">}</span>
<span class="n">asl</span> <span class="o">=</span> <span class="n">BaseActiveLearner</span><span class="p">(</span><span class="n">estimator</span> <span class="o">=</span> <span class="n">BaseITEEstimator</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(),</span>
                                         <span class="n">two_model</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">ps_model</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
                        <span class="n">acquisition_function</span><span class="o">=</span><span class="n">RandomAcquisitionFunction</span><span class="p">(),</span>
                        <span class="n">assignment_function</span><span class="o">=</span><span class="n">MajorityAssignmentFunction</span><span class="p">(),</span>
                        <span class="n">stopping_function</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="n">dataset</span><span class="o">=</span><span class="n">ds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">asl</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">X_new</span><span class="p">,</span> <span class="n">query_idx</span> <span class="o">=</span> <span class="n">asl</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">no_query</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
<span class="n">asl</span><span class="o">.</span><span class="n">teach</span><span class="p">(</span><span class="n">query_idx</span><span class="p">)</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">asl</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">asl</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;X_test&quot;</span><span class="p">])</span>
<span class="n">asl</span><span class="o">.</span><span class="n">score</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_latex output_subarea output_execute_result">
$\displaystyle 1.8020073300998505$
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">CausalForestEstimator</span><span class="p">(</span><span class="n">BaseITEEstimator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Y</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;y_training&quot;</span><span class="p">],</span> 
                       <span class="n">T</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;t_training&quot;</span><span class="p">],</span> 
                       <span class="n">X</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;X_training&quot;</span><span class="p">])</span>
        
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">effect_inference</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bite</span> <span class="o">=</span> <span class="n">BaseITEEstimator</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(),</span>
                        <span class="n">two_model</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="n">ps_model</span>  <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="n">dataset</span>   <span class="o">=</span> <span class="n">ds</span><span class="p">)</span>
<span class="n">bite</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">bite</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;X_test&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">preds</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(673,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bite</span> <span class="o">=</span> <span class="n">CausalForestEstimator</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">CausalForestDML</span><span class="p">(),</span>
                        <span class="n">two_model</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="n">ps_model</span>  <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="n">dataset</span>   <span class="o">=</span> <span class="n">ds</span><span class="p">)</span>
<span class="n">bite</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">bite</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;X_test&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.00023878179109915187, tolerance: 0.0001862068965517241
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.00019861933142767407, tolerance: 0.0001862068965517241
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.0002549436799918481, tolerance: 0.0001862068965517241
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.00025595963433600044, tolerance: 0.0001862068965517241
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.00025413783953390223, tolerance: 0.0001862068965517241
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.0002504295467397333, tolerance: 0.0001862068965517241
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.000245227360750333, tolerance: 0.0001862068965517241
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.00021518807409481866, tolerance: 0.0001862068965517241
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.00020860311939860376, tolerance: 0.0001862068965517241
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.00019982027603397678, tolerance: 0.0001862068965517241
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.0001909318421768058, tolerance: 0.0001862068965517241
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.004719380471176371, tolerance: 0.00034482758620689674
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.007286905966478352, tolerance: 0.00034482758620689674
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.008036124461645477, tolerance: 0.00034482758620689674
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.0029373169744422167, tolerance: 0.00034482758620689674
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.004333470963829744, tolerance: 0.00034482758620689674
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.008071875387015481, tolerance: 0.00034482758620689674
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.009398165863549357, tolerance: 0.00034482758620689674
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.009720162882728367, tolerance: 0.00034482758620689674
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.009645259562582442, tolerance: 0.00034482758620689674
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.009417495748331506, tolerance: 0.00034482758620689674
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.009133712979323971, tolerance: 0.00034482758620689674
Objective did not converge. You might want to increase the number of iterations. Duality gap: 0.008832618851469687, tolerance: 0.00034482758620689674
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">CEVAEEstimator</span><span class="p">(</span><span class="n">BaseITEEstimator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;X_training&quot;</span><span class="p">],</span> 
                       <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;t_training&quot;</span><span class="p">],</span> 
                       <span class="n">y</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;y_training&quot;</span><span class="p">])</span>
        
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">oite</span> <span class="o">=</span> <span class="n">CEVAEEstimator</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">CEVAE</span><span class="p">(</span><span class="n">num_epochs</span><span class="o">=</span><span class="mi">200</span><span class="p">),</span><span class="n">dataset</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span><span class="n">two_model</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">oite</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO 	 Training with 1 minibatches per epoch
DEBUG 	 step     0 loss = 51.9761
DEBUG 	 step   100 loss = 51.8092
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">oite</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="s2">&quot;X_test&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>INFO 	 Evaluating 7 minibatches
DEBUG 	 batch ate = 0.0335
DEBUG 	 batch ate = 0.0351714
DEBUG 	 batch ate = 0.0355929
DEBUG 	 batch ate = 0.033358
DEBUG 	 batch ate = 0.0333606
DEBUG 	 batch ate = 0.0339525
DEBUG 	 batch ate = 0.0349995
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([ 0.02380372,  0.03753278,  0.03375819,  0.01448341,  0.04317872,
        0.05272769,  0.01554757,  0.03563935,  0.01330731,  0.05732586,
        0.04199777,  0.04108307,  0.01120973,  0.06161702,  0.0115727 ,
       -0.01127352,  0.01735784,  0.04027123,  0.06475301,  0.02026938,
        0.03812422,  0.02693428,  0.03358282,  0.02318649,  0.00703158,
        0.03840056,  0.02500667,  0.02530897,  0.03432959,  0.06638729,
        0.04284822,  0.0544694 ,  0.04991947,  0.02723821,  0.03221272,
        0.04392564,  0.02657603,  0.03035397,  0.04416728,  0.03402237,
        0.04793348,  0.02274182,  0.0213143 ,  0.02463887,  0.0493146 ,
        0.04827039,  0.03611295,  0.03486931,  0.01343055,  0.04640395,
        0.04089176,  0.03350814,  0.04244459,  0.04443329,  0.0376547 ,
        0.04285055,  0.03170737,  0.03722721,  0.00648796,  0.04834443,
        0.02349181,  0.04079063,  0.02966079,  0.01708325,  0.04422752,
        0.02475532,  0.02300748,  0.05030443,  0.0461943 ,  0.00667773,
        0.04118654,  0.00714651,  0.03595178,  0.0067144 ,  0.06022935,
        0.04962365,  0.0140721 ,  0.05531   ,  0.05741514,  0.02960396,
        0.01402312,  0.02166981,  0.02723899,  0.04039545,  0.02708483,
        0.03629337,  0.04751682,  0.03335264,  0.02175563,  0.04165237,
        0.03965894,  0.03529757,  0.03360751,  0.0617612 ,  0.0122942 ,
        0.01112711,  0.03050186,  0.0421849 ,  0.02887436,  0.03948968,
        0.06069456,  0.04839616,  0.01321453,  0.05020746,  0.04498238,
        0.02879714,  0.05283625,  0.0531961 ,  0.02275835,  0.01717168,
        0.03744455,  0.02467515,  0.05808653,  0.03327933,  0.04014907,
        0.07223767,  0.04081621,  0.04842352,  0.02020478,  0.02843052,
        0.01693747,  0.04910574,  0.05709231,  0.02225092,  0.03320365,
        0.0327514 ,  0.04605129,  0.05108761,  0.02324116,  0.04366087,
        0.04496491,  0.01104295,  0.02950891,  0.01056187,  0.05355708,
        0.04561588,  0.03795183,  0.03221693,  0.04872207,  0.03929675,
        0.04890405,  0.03659935,  0.04431372,  0.03420121,  0.0411565 ,
        0.02138638,  0.06357508,  0.01528979,  0.0093736 ,  0.01782924,
        0.025996  ,  0.03216747,  0.0364561 ,  0.04653717,  0.05453014,
        0.02532511,  0.03732363,  0.07433064,  0.03630226,  0.03281616,
        0.04642016,  0.03717655,  0.00525215,  0.03487917,  0.05091251,
        0.04019503,  0.03484094,  0.04272034,  0.03402846,  0.01171652,
        0.02955775,  0.05327278,  0.00112006,  0.04348741,  0.00710832,
        0.03147827,  0.04013207,  0.02655276,  0.02324357,  0.0247348 ,
        0.02465884,  0.0166557 ,  0.01665799,  0.05080637,  0.04727548,
        0.05193777,  0.00513137,  0.04479358,  0.0420077 ,  0.04205653,
        0.03039891,  0.03360169, -0.00481767,  0.00101301,  0.03623439,
        0.02825679,  0.05063604,  0.0454911 ,  0.04469135,  0.03158788,
        0.02108941,  0.03004509,  0.04074831,  0.03881483,  0.03623536,
        0.05561677,  0.04562407,  0.03042458,  0.02917659,  0.05732355,
        0.0515415 ,  0.03705768,  0.03026555,  0.0512046 ,  0.00760683,
        0.05957337,  0.04715349,  0.03327514,  0.02634325,  0.03483228,
        0.00662678,  0.01963901,  0.03313133,  0.04125366,  0.02273521,
        0.0368532 ,  0.03944684,  0.02989871,  0.03145543,  0.035064  ,
        0.03633104,  0.05201734,  0.02192195,  0.03232531,  0.04370854,
        0.02376846,  0.03127635,  0.04228112,  0.04952898,  0.05037517,
        0.05537017,  0.05456584,  0.0540381 ,  0.01826005,  0.04861619,
        0.01900018,  0.032019  ,  0.02861597,  0.02353945,  0.04329673,
        0.05407893,  0.06118038,  0.03658742,  0.02525325,  0.03205152,
        0.02693099,  0.0214186 ,  0.03632071,  0.03419112,  0.02230375,
        0.01932461, -0.00289497,  0.05069244,  0.06110866,  0.02546891,
        0.03907011,  0.04175526,  0.04144114,  0.02542198,  0.0658909 ,
        0.02447723,  0.02016429,  0.0361435 ,  0.02287267,  0.04473507,
        0.04206301,  0.06799802,  0.05193643,  0.04361195,  0.03398664,
        0.04404962,  0.05693132,  0.03671055,  0.02902236,  0.03234553,
        0.00885043,  0.03662378,  0.04201756,  0.01636571,  0.02121654,
        0.02206372,  0.03584621,  0.01496572, -0.01790034,  0.04164128,
        0.03681995,  0.03658147,  0.03818549,  0.07554587,  0.02490874,
        0.03630987,  0.02998145,  0.04841255,  0.0506336 ,  0.06074619,
        0.04297777,  0.055771  ,  0.01279654,  0.04653775,  0.03512541,
        0.02561078,  0.04779404,  0.01614983,  0.01033337,  0.02196733,
        0.01523951,  0.02876442,  0.03219501,  0.01535668,  0.01145884,
        0.03875895,  0.04303786,  0.02156092,  0.05417943,  0.02953252,
        0.05388832,  0.03770326,  0.0400332 , -0.00271988,  0.02645974,
        0.03116834,  0.01525321,  0.05023448,  0.01380792,  0.05510159,
        0.04124352,  0.03683531,  0.05875777,  0.05607978,  0.04922835,
        0.0496078 ,  0.04533952,  0.00791958,  0.06406618,  0.0304787 ,
        0.01402795,  0.02541044,  0.04383839,  0.05345886,  0.0310604 ,
        0.0314261 ,  0.0204957 ,  0.03075703,  0.03622069,  0.03454949,
        0.0239259 ,  0.03410327,  0.03160223,  0.03663279,  0.02681641,
        0.04582276,  0.01881815,  0.05464715,  0.01702951,  0.03509436,
        0.01105975,  0.03024979,  0.01830899,  0.02957202,  0.06086419,
        0.04534161,  0.03657469,  0.05457212, -0.00170319,  0.02724663,
        0.05790659,  0.01657446,  0.04421322,  0.02199445,  0.0337368 ,
        0.0414995 ,  0.02106974,  0.02747837,  0.02452085,  0.00193049,
        0.0489834 ,  0.01196066,  0.04121   ,  0.03124816,  0.0457107 ,
        0.0445001 ,  0.01308444,  0.04304034,  0.02334514,  0.03610082,
        0.04773759,  0.02326595,  0.02815738,  0.03026622,  0.02672489,
        0.04022119,  0.05448541,  0.04489474,  0.02623799,  0.001046  ,
        0.0203659 ,  0.01314344,  0.05645134,  0.0353483 ,  0.04016773,
        0.01647807,  0.05300439,  0.02770449,  0.04785031,  0.03238393,
        0.04593213, -0.01525022,  0.00722757,  0.04512362,  0.0309748 ,
        0.0454065 ,  0.04356872,  0.03889409,  0.02790647,  0.03941581,
        0.01255708,  0.04334141,  0.04209745,  0.05954694,  0.0505686 ,
        0.0207554 ,  0.0313004 ,  0.04240287,  0.04704727,  0.0458744 ,
        0.0414317 ,  0.01668136,  0.02499931,  0.0168428 ,  0.02772569,
        0.04520161,  0.01680471,  0.03955231,  0.01801102,  0.05081329,
        0.03891281,  0.03500237,  0.02760285,  0.03295542,  0.04498159,
        0.03644271,  0.04065925,  0.00982797,  0.03647346,  0.03213719,
        0.02214127,  0.04099937, -0.00687275,  0.0205786 , -0.0089952 ,
        0.02350317,  0.04821486,  0.02495391,  0.02581056,  0.03896391,
        0.04887762,  0.02919179,  0.04513178,  0.02727886,  0.00772028,
        0.04032966,  0.0545978 , -0.00218203,  0.05145171,  0.02536906,
        0.03845054,  0.02564409,  0.0553544 ,  0.05374825,  0.02128705,
        0.03752631,  0.0308317 ,  0.0375062 ,  0.05711705,  0.04999858,
        0.03308276,  0.03042867,  0.03840495,  0.03437919,  0.00558491,
        0.05009484,  0.06615692,  0.07612108,  0.02553586,  0.03596489,
        0.03792956,  0.03756725,  0.01144554,  0.02745691,  0.01384533,
        0.01398269,  0.04486923,  0.0280302 ,  0.01098261,  0.06484384,
        0.0193164 ,  0.02599676,  0.02799295,  0.02306175,  0.03933134,
        0.01906031,  0.04798548,  0.01947476,  0.02857142,  0.03446485,
        0.00285272,  0.04942511,  0.04231508,  0.05264829,  0.06278008,
        0.00766778,  0.03668704,  0.04090652,  0.02225494,  0.0375351 ,
        0.0407636 ,  0.01665572,  0.04869831,  0.03575375,  0.04081015,
        0.05439673,  0.02893751,  0.02988738,  0.05219556,  0.02947429,
        0.02244281,  0.0438402 ,  0.02214596,  0.03400663,  0.04778296,
        0.01948232,  0.02101304,  0.04735334,  0.03694293,  0.0098205 ,
        0.0359184 ,  0.01837669,  0.03768266,  0.05296872,  0.02314156,
        0.00439202,  0.0497155 , -0.00211049,  0.04964155,  0.05009164,
        0.04715883,  0.02758581,  0.04209775,  0.04669714,  0.02776157,
        0.04500071,  0.06280281,  0.03538677,  0.02614672,  0.04433204,
        0.02877381,  0.01201542,  0.03451575,  0.02239012,  0.01459265,
        0.05495206,  0.00982617,  0.03305868,  0.04320388,  0.026139  ,
        0.04884015,  0.02785341,  0.05257304,  0.02850209,  0.03200237,
        0.04457388,  0.01926242,  0.04622411,  0.03757988,  0.04470656,
        0.00407655,  0.01714056,  0.00994431,  0.0656936 ,  0.04523117,
        0.03594209,  0.04025036,  0.04178526,  0.03917733,  0.00054264,
        0.04736463,  0.05100065,  0.02817811,  0.06551354,  0.03159362,
        0.03957342,  0.042156  ,  0.02808656,  0.0322158 ,  0.0307587 ,
        0.03853277,  0.0390875 ,  0.02624584,  0.04672859,  0.03387657,
        0.04580278,  0.04339693,  0.04411413,  0.0258486 ,  0.00224249,
        0.04972172,  0.03297553,  0.03816857,  0.00677281,  0.04059457,
        0.04456561,  0.01518556,  0.02801101,  0.04602777,  0.0552935 ,
        0.04814662,  0.04707436,  0.0509314 ,  0.05663385,  0.0261581 ,
        0.0363078 ,  0.03208097, -0.00245369,  0.04026864,  0.03080631,
        0.0185367 ,  0.03845802,  0.02717243,  0.02232422,  0.04583519,
        0.04381336,  0.03248112,  0.05554301,  0.03541963,  0.02456863,
        0.03127104,  0.00201259,  0.06238752,  0.03549216,  0.02808755,
        0.05279485,  0.00295874,  0.06153721,  0.05063136,  0.04958765,
        0.03396105,  0.0170871 ,  0.0378807 ,  0.01469835,  0.03558786,
        0.05072808,  0.05495323,  0.00519371,  0.02207337,  0.03879909,
        0.00187627,  0.04746934,  0.03101069,  0.0495888 ,  0.0361558 ,
        0.04239047,  0.04178423,  0.03087196], dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

